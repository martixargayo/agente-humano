<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Avatar 3D â€“ Agente Humano</title>
  <script type="importmap">
    {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.160/build/three.module.js",
        "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160/examples/jsm/"
      }
    }
  </script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #000;
      color: #fff;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    #ui {
      position: absolute;
      top: 16px;
      left: 16px;
      z-index: 10;
      background: rgba(0,0,0,0.6);
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 14px;
    }
    #lastReply {
      display: block;
      margin-top: 4px;
      font-size: 13px;
      color: #e5e7eb;
      max-width: 320px;
      word-wrap: break-word;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <div id="ui">
    <div>
      <label>
        <input type="radio" name="agentMode" value="chat" checked />
        Chat normal
      </label>
      <label style="margin-left: 8px;">
        <input type="radio" name="agentMode" value="negociar" />
        Negociador
      </label>
    </div>

    <div style="margin-top: 6px;">
      <textarea id="userText" rows="2" style="width: 320px;"></textarea>
    </div>

    <div style="margin-top: 4px;">
      <label>
        <input type="checkbox" id="textOnly" />
        Solo texto (sin voz)
      </label>
    </div>

    <div style="margin-top: 6px; font-size: 13px;">
      <div>Estado emocional</div>
      <select id="emotionSelect" style="width: 180px; margin-top: 4px;">
        <option value="neutral" selected>Neutral</option>
        <option value="happy">Feliz / alegre</option>
        <option value="angry">Enfado / tensiÃ³n</option>
        <option value="sad">Triste / calmado</option>
      </select>
      <div style="margin-top: 6px;">
        <label for="expressionIntensity">Intensidad facial</label>
        <input type="range" id="expressionIntensity" min="0" max="1" step="0.05" value="0.45" />
        <span id="expressionValue" style="font-size:12px;color:#9ca3af;">0.45</span>
      </div>
      <div style="margin-top: 6px;">
        <label>
          <input type="checkbox" id="idleMotionToggle" checked />
          Movimiento idle (respiraciÃ³n / balanceo)
        </label>
      </div>
    </div>

    <!-- BOTÃ“N ENVIAR TEXTO -->
    <button id="sendToAgentBtn" style="margin-top: 6px;">Enviar al agente</button>

    <!-- NUEVO: BOTÃ“N MIC + ONDAS -->
    <div style="margin-top: 6px;">
      <button id="micBtn">ðŸŽ¤ Hablar</button>
    </div>
    <canvas id="waveCanvas" width="320" height="40"
            style="margin-top:4px;background:rgba(15,23,42,0.9);border-radius:4px;"></canvas>
    <div id="micLabel" style="font-size:12px;margin-top:2px;color:#9ca3af;">
      Pulsa el micro y habla
    </div>

    <div style="margin-top: 6px; font-size: 12px;">
      Respuesta:
      <span id="lastReply"></span>
    </div>

    <button id="demoBtn" style="margin-top: 6px;">Demo labios (sin audio)</button>
  </div>

  <canvas id="c"></canvas>

  <script type="module" src="./app.js"></script>
</body>
</html>

